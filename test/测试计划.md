# Web Generator 模板测试计划

## 测试目标
对Flask和FastAPI模板进行全面测试，确保生成的项目功能完整、接口正常、测试通过、文档可访问。

## 测试环境准备
- Python 3.8+
- 虚拟环境
- 必要的依赖包

## 一、Flask模板测试

### 1.1 项目生成测试
1. 使用生成器创建Flask项目
   - 项目名称：flask_test_project
   - 数据库：PostgreSQL
   - 启用Redis：是
   - 启用Docker：是
   - 启用认证：否（已移除）

2. 检查生成的文件结构
   - 验证所有必要文件是否存在
   - 检查模板渲染是否正确
   - 确认没有认证相关文件

### 1.2 项目启动测试
1. 进入项目目录
2. 创建虚拟环境：`python3 -m venv venv`
3. 激活虚拟环境：`source venv/bin/activate`
4. 安装依赖：`pip install -r requirements.txt`
5. 设置环境变量：`cp .env.example .env`（如果存在）
6. 初始化数据库（如果需要）
7. 启动应用：`python run.py`
8. 验证应用是否正常启动

### 1.3 API接口测试
1. 健康检查接口
   - GET `/api/v1/health`
   - 预期返回：200状态码，包含status字段

2. 信息接口
   - GET `/api/v1/info`
   - 预期返回：200状态码，包含版本和名称信息

3. 使用curl或Postman测试所有接口
4. 验证响应格式和状态码

### 1.4 API文档测试
1. 访问Swagger文档：`http://localhost:5000/docs`
2. 验证文档页面是否正常加载
3. 检查API端点是否正确显示
4. 测试文档中的"Try it out"功能
5. 验证响应示例是否正确

### 1.5 单元测试
1. 运行pytest：`pytest`
2. 检查测试覆盖率：`pytest --cov=app`
3. 验证所有测试用例通过
4. 检查测试报告

### 1.6 功能验证
1. 数据库连接测试
2. Redis连接测试（如果启用）
3. 日志功能测试
4. 错误处理测试
5. 静态文件服务测试

## 二、FastAPI模板测试

### 2.1 项目生成测试
1. 使用生成器创建FastAPI项目
   - 项目名称：fastapi_test_project
   - 数据库：MySQL
   - 启用Redis：是
   - 启用Docker：是
   - 启用认证：否

2. 检查生成的文件结构
   - 验证所有必要文件是否存在
   - 检查模板渲染是否正确
   - 确认项目结构符合FastAPI最佳实践

### 2.2 项目启动测试
1. 进入项目目录
2. 创建虚拟环境：`python -m venv venv`
3. 激活虚拟环境：`source venv/bin/activate`
4. 安装依赖：`pip install -r requirements.txt`
5. 设置环境变量
6. 启动应用：`uvicorn app.main:app --reload`
7. 验证应用是否正常启动

### 2.3 API接口测试
1. 根路径接口
   - GET `/`
   - 预期返回：欢迎信息

2. 健康检查接口
   - GET `/health`
   - 预期返回：200状态码，健康状态信息

3. API版本接口
   - GET `/api/v1/`相关端点
   - 验证所有定义的接口

4. 使用curl或Postman测试所有接口

### 2.4 API文档测试
1. 访问自动生成的文档：`http://localhost:8000/docs`
2. 访问ReDoc文档：`http://localhost:8000/redoc`
3. 验证文档页面是否正常加载
4. 检查API端点是否正确显示
5. 测试交互式API文档功能
6. 验证模型定义是否正确

### 2.5 单元测试
1. 运行pytest：`pytest`
2. 检查测试覆盖率：`pytest --cov=app`
3. 验证所有测试用例通过
4. 检查异步测试是否正常工作

### 2.6 功能验证
1. 数据库连接测试
2. Redis连接测试（如果启用）
3. 异步功能测试
4. 中间件功能测试
5. 依赖注入测试

## 三、Docker测试（如果启用）

### 3.1 Flask Docker测试
1. 构建Docker镜像：`docker build -t flask_test .`
2. 运行容器：`docker run -p 5000:5000 flask_test`
3. 测试容器中的应用是否正常工作
4. 测试docker-compose（如果存在）：`docker-compose up`

### 3.2 FastAPI Docker测试
1. 构建Docker镜像：`docker build -t fastapi_test .`
2. 运行容器：`docker run -p 8000:8000 fastapi_test`
3. 测试容器中的应用是否正常工作
4. 测试docker-compose（如果存在）：`docker-compose up`

## 四、性能测试

### 4.1 基础性能测试
1. 使用ab或wrk进行压力测试
2. 测试并发请求处理能力
3. 监控内存和CPU使用情况

### 4.2 响应时间测试
1. 测试各个接口的响应时间
2. 验证是否在可接受范围内

## 五、问题记录和修复

### 5.1 问题记录格式
- 问题描述
- 复现步骤
- 预期结果
- 实际结果
- 解决方案

### 5.2 模板修复
- 发现问题后立即修改相应模板文件
- 重新生成项目进行验证
- 确保修复不影响其他功能

## 六、测试报告

### 6.1 测试结果汇总
- 通过的测试项目
- 失败的测试项目
- 发现的问题及解决情况

### 6.2 改进建议
- 模板优化建议
- 功能增强建议
- 文档改进建议

## 七、测试执行顺序

1. 首先测试Flask模板的完整流程
2. 记录并修复发现的问题
3. 然后测试FastAPI模板的完整流程
4. 记录并修复发现的问题
5. 进行交叉验证和回归测试
6. 生成最终测试报告

## 测试结果记录

### Flask 模板测试
- [x] 项目生成测试 - ✅ 成功生成完整项目结构
- [x] API 测试 - ✅ 健康检查和信息端点正常工作
- [x] Pytest 测试 - ✅ 所有测试用例通过
- [x] API 文档测试 - ✅ 文档正确生成，包含完整API说明
- [ ] Docker 测试

### FastAPI 模板测试
- [x] 项目生成测试 - ✅ 成功生成完整项目结构，所有27个预期文件都存在
- [x] API 测试 - ✅ 健康检查端点正常工作，应用成功启动在端口8001
- [x] Pytest 测试 - ✅ 所有测试用例通过（2个测试用例）
- [x] API 文档测试 - ✅ API文档正确生成
- [ ] Docker 测试

## 注意事项

1. 每个测试步骤都要详细记录结果
2. 发现问题要立即停止，先修复模板再继续
3. 确保测试环境的一致性
4. 保存测试过程中的日志和截图
5. 测试完成后清理测试项目和环境